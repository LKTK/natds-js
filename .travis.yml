---
branches:
  except:
    - /v\d+\.\d+\.\d+$/
    - /v\d+\.\d+\.\d+-docs$/
cache:
  directories:
    - node_modules
    - packages/icons/node_modules
    - packages/web/node_modules
    - packages/styles/node_modules
    - packages/docs/node_modules
dist: xenial
jobs:
  include:
    - stage: dependency-check
      if: "branch =~ /^dependabot\\/(.+)$/ OR branch =~ /^renovate\\/(.+)$/"
      script: "echo \"yarn verify:ci\""
    - stage: prerelease
      deploy:
        provider: script
        script: "echo \"yarn prerelease $TRAVIS_BRANCH && yarn publish\""
      if: "branch =~ /^DSY-(\\d+)$/ OR branch =~ /^feature\\/(.+)$/ OR branch =~ /^hotfix\\/(.+)$/"
    - stage: release
      deploy:
        provider: script
        script: "echo \"yarn release && yarn publish\""
        on:
          branch: master
language: node_js
node_js:
  - lts/*
os: linux
